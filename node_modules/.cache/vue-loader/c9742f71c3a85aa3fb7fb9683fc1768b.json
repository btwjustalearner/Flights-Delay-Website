{"remainingRequest":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/src/components/Map2.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/src/components/Map2.vue","mtime":1575442457000},{"path":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/huangyan/Documents/GitHub/a5-null/travelwebsite/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpmdW5jdGlvbiBncm91cEJ5KCBhcnJheSAsIGYgKSB7CiAgICAgICAgICAgICAgICBsZXQgZ3JvdXBzID0ge307CiAgICAgICAgICAgICAgICBhcnJheS5mb3JFYWNoKCBmdW5jdGlvbiggbyApIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZ3JvdXAgPSBKU09OLnN0cmluZ2lmeSggZihvKSApOwogICAgICAgICAgICAgICAgICAgIGdyb3Vwc1tncm91cF0gPSBncm91cHNbZ3JvdXBdIHx8IFtdOwogICAgICAgICAgICAgICAgICAgIGdyb3Vwc1tncm91cF0ucHVzaCggbyApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoZ3JvdXBzKS5tYXAoIGZ1bmN0aW9uKCBncm91cCApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXBzW2dyb3VwXTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CmZ1bmN0aW9uIG1heGFycihhcnIsbGVuKXsKICAgICAgICAgICAgICAgIHZhciBtYXg9W107CiAgICAgICAgICAgICAgICBhcnIuc29ydChmdW5jdGlvbihhLGIpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhWydDb3VudCddLWJbJ0NvdW50J10KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7aTxsZW47aSsrKXsKICAgICAgICAgICAgICAgICAgICBtYXgucHVzaChhcnIucG9wKCkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbWF4LnJldmVyc2UoKQogICAgICAgICAgICB9CmZ1bmN0aW9uIHByZXBhcmVkYXRhKGZsaWdodHMpewogICAgdmFyIGdyb3VwZWRfYWxsID0gZ3JvdXBCeShmbGlnaHRzLCBmdW5jdGlvbihpdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtpdGVtLm9yaWdpbl07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50PTAuMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbnVtPTAuMDsKICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBfYWxsPW5ldyBBcnJheSgpCiAgICAgICAgICAgICAgICAgICAgdmFyIGRpYz1uZXcgQXJyYXkoKQogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZ3JvdXBlZF9hbGwpCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZF9hbGwuZm9yRWFjaCgKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW09MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5mb3JFYWNoKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKG0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1jb3VudCtwYXJzZUludChtWydkZWxheSddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtPW51bSsxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYz1bXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljWydvcmlnaW4nXT1lWzBdWydvcmlnaW4nXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljWydkZWxheSddPWNvdW50L251bQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkaWMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cF9hbGwucHVzaChkaWMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApCgoKICAgICAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICAgICAgdmFyIE49MTAKICAgICAgICAgICAgICAgICAgICBncm91cF9hbGw9bWF4YXJyKGdyb3VwX2FsbCxOKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBncm91cF9hbGw7Cn0KZnVuY3Rpb24gdXBkYXRlKGRhdGEpIHsKICAgICAgICAgICAgZGF0YT1kYXRhLnNvcnQoZnVuY3Rpb24oYSxiKXsKICAgICAgICAgICAgICAgIHJldHVybiBhLmRlbGF5LWIuZGVsYXk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KCIjY2hhcnQiKTsKICAgICAgICAgICAgIHZhciByZWN0cyA9IHN2Zy5zZWxlY3RBbGwoInJlY3QiKQogICAgICAgICAgICAgLmRhdGEoZGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQub3JpZ2luOyB9KTsKICAgICAgICAgICAgIHJlY3RzLmV4aXQoKSAvL0VYSVQgU0VMRUNUSU9OIC0tIGhlcmUgd2UgZGVjaWRlIHRvIGV4aXQgZmlyc3QKICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkKICAgICAgICAgICAgIC5kZWxheSgxMDAwKQogICAgICAgICAgICAgLmR1cmF0aW9uKDEwMDApCiAgICAgICAgICAgICAuc3R5bGUoIm9wYWNpdHkiLCAwKQogICAgICAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICAgICAgIHZhciB5U2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXhudW09MAogICAgICAgICAgICAgICAgICAgIHZhciBtaW5udW09MTAwMDAwMDAKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXVsnZGVsYXknXT5tYXhudW0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4bnVtPWRhdGFbaV1bJ2RlbGF5J10KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXVsnZGVsYXknXTxtaW5udW0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlubnVtPWRhdGFbaV1bJ2RlbGF5J10KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgeVNjYWxlLmRvbWFpbihbbWF4bnVtLG1pbm51bV0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5yYW5nZShbMTAwLDYwMF0pOwoKCgogICAgICAgICAgICB2YXIgY29sb3JsaXN0PVsnI0ZGMDAwMCcsJyNGRjAwNkInLCcjRkYwMEVCJywnI0NBMDBGRicsJyMzODAwRkYnLCcjMDAwMEZGJywnIzAwOTRGRicsJyMwMEZGRkYnLCcjMDBGRkFEJywnIzAwRkYwMCddOwoKICAgICAgICAgICAgIHJlY3RzLmVudGVyKCkgLy9FTlRFUgogICAgICAgICAgICAgLmFwcGVuZCgicmVjdCIpCiAgICAgICAgICAgICAuYXR0cigiZmlsbCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuYzsgfSkKICAgICAgICAgICAgIC5tZXJnZShyZWN0cykgLy8gVVBEQVRFICsgRU5URVIKICAgICAgICAgICAgIC50cmFuc2l0aW9uKCkKICAgICAgICAgICAgIC5kdXJhdGlvbigzMDAwKQogICAgICAgICAgICAgLmRlbGF5KGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGkgKiAxMDA7IH0pCiAgICAgICAgICAgICAuYXR0cigieCIsIDApCiAgICAgICAgICAgICAuYXR0cigieSIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGkgKiAzNTsgfSkKICAgICAgICAgICAgIC5hdHRyKCJ3aWR0aCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHlTY2FsZShkLmRlbGF5KTsgfSkKICAgICAgICAgICAgIC5hdHRyKCJoZWlnaHQiLCAyNSkKICAgICAgICAgICAgIC5hdHRyKCJmaWxsIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gY29sb3JsaXN0W2ldOyB9KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBzdmcuc2VsZWN0QWxsKCIjdGV4dCIpLnJlbW92ZSgpOwogICAgICAgICAgICB2YXIgdGV4dD1zdmcuc2VsZWN0QWxsKCJ0ZXh0IikuZGF0YShkYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5vcmlnaW47IH0pCiAgICAgICAgICAgIHRleHQuZW50ZXIoKS5hcHBlbmQoInRleHQiKQogICAgICAgICAgICAubWVyZ2UocmVjdHMpIC8vIFVQREFURSArIEVOVEVSCiAgICAgICAgICAgICAudHJhbnNpdGlvbigpCiAgICAgICAgICAgICAuZHVyYXRpb24oMzAwMCkKICAgICAgICAgICAgIC5kZWxheShmdW5jdGlvbihkLCBpKSB7IHJldHVybiBpICogMTAwOyB9KQogICAgICAgICAgICAudGV4dChmdW5jdGlvbihkKXsKICAgICAgICAgICAgICAgIHJldHVybiBkLm9yaWdpbjsKICAgICAgICAgICAgfSkuYXR0cigieCIsZnVuY3Rpb24oZCkgeyByZXR1cm4geVNjYWxlKGQuZGVsYXkpKzUwOyB9KQogICAgICAgICAgICAuYXR0cigieSIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIGkgKiAzNSsyMDsgfSkKICAgICAgICAgICAgLmF0dHIoImlkIiwidGV4dCIpCgoKICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgIAoKCgoKCiAgICBpbXBvcnQgKiBhcyBkMyBmcm9tICdkM3Y0JzsKICAgIGltcG9ydCAqIGFzIHRvcG9qc29uIGZyb20gJ3RvcG9qc29uJzsKICAgIGV4cG9ydCBkZWZhdWx0IHsKICAgICAgICBuYW1lOiAiTWFwMiIsCiAgICAgICAgbW91bnRlZCgpewogICAgICAgICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KCJzdmciKSwKICAgICAgICAgICAgICAgIHdpZHRoID0gK3N2Zy5hdHRyKCJ3aWR0aCIpLAogICAgICAgICAgICAgICAgaGVpZ2h0ID0gK3N2Zy5hdHRyKCJoZWlnaHQiKTsKCiAgICAgICAgICAgIHZhciBwcm9qZWN0aW9uID0gZDMuZ2VvQWxiZXJzKCkKICAgICAgICAgICAgICAgIC50cmFuc2xhdGUoW3dpZHRoICowLjYsIGhlaWdodCAqIDAuNl0pCiAgICAgICAgICAgICAgICAuc2NhbGUoNTUwKTsKCiAgICAgICAgICAgIC8vIHZhciByYWRpdXMgPSBkMy5zY2FsZVNxcnQoKQogICAgICAgICAgICAvLyAgICAgLmRvbWFpbihbMCwgMTAwXSkKICAgICAgICAgICAgLy8gICAgIC5yYW5nZShbMCwgMTRdKTsKCiAgICAgICAgICAgIHZhciBwYXRoID0gZDMuZ2VvUGF0aCgpCiAgICAgICAgICAgICAgICAucHJvamVjdGlvbihwcm9qZWN0aW9uKQogICAgICAgICAgICAgICAgLnBvaW50UmFkaXVzKDIuNSk7CgogICAgICAgICAgICB2YXIgdm9yb25vaSA9IGQzLnZvcm9ub2koKQogICAgICAgICAgICAgICAgLmV4dGVudChbWy0xLCAtMV0sIFt3aWR0aCArIDEsIGhlaWdodCArIDFdXSk7CgogICAgICAgICAgICB2YXIgZmlsdGVyX21vZGUgPSAiI2FsbCI7CiAgICAgICAgICAgIHNldEZpbHRlck1vZGUoZmlsdGVyX21vZGUpCgogICAgICAgICAgICB2YXIgYWlycG9ydHMwOwogICAgICAgICAgICB2YXIgZmxpZ2h0czA7CiAgICAgICAgICAgIHZhciB1czA7CgogICAgICAgICAgICBkMy5xdWV1ZSgpCiAgICAgICAgICAgICAgICAuZGVmZXIoZDMuanNvbiwgImRhdGEvdXMuanNvbiIpCiAgICAgICAgICAgICAgICAuZGVmZXIoZDMuY3N2LCAiZGF0YS9haXJwb3J0cy5jc3YiLCB0eXBlQWlycG9ydCkKICAgICAgICAgICAgICAgIC5kZWZlcihkMy5jc3YsICJkYXRhL2ZsaWdodHMtYWdncmVnYXRpb24uY3N2IiwgdHlwZUZsaWdodCkKICAgICAgICAgICAgICAgIC5hd2FpdChyZWFkeSk7CgogICAgICAgICAgICBmdW5jdGlvbiByZWFkeShlcnJvciwgdXMsIGFpcnBvcnRzLCBmbGlnaHRzKSB7CiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yOwogICAgICAgICAgICAgICAgZmxpZ2h0czAgPSBmbGlnaHRzLnNsaWNlKCk7CiAgICAgICAgICAgICAgICBhaXJwb3J0czAgPSBhaXJwb3J0cy5zbGljZSgpOwogICAgICAgICAgICAgICAgdXMwID0gdXM7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhaXJwb3J0c1syNTMxXSkKICAgICAgICAgICAgICAgIGZsaWdodHMgPSBmbGlnaHRzLmZpbHRlcihkID0+IGQuY2FycmllciA9PSAnYWxsJyk7CgogICAgICAgICAgICAgICAgdmFyIGFpcnBvcnRCeUlhdGEgPSBkMy5tYXAoYWlycG9ydHMsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuaWF0YTsgfSk7CgogICAgICAgICAgICAgICAgZmxpZ2h0cy5mb3JFYWNoKGZ1bmN0aW9uKGZsaWdodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhaXJwb3J0QnlJYXRhLmdldChmbGlnaHQub3JpZ2luKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gYWlycG9ydEJ5SWF0YS5nZXQoZmxpZ2h0LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAgICAgICBzb3VyY2UuYXJjcy5jb29yZGluYXRlcy5wdXNoKFtzb3VyY2UsIHRhcmdldF0pOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hcmNzLmNvb3JkaW5hdGVzLnB1c2goW3RhcmdldCwgc291cmNlXSk7CiAgICAgICAgICAgICAgICAgICAgc291cmNlLmRlbGF5ID0gZmxpZ2h0LmRlbGF5OwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhaXJwb3J0cykKCiAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICBhaXJwb3J0cyA9IGFpcnBvcnRzCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihkKSB7IHJldHVybiBkLmFyY3MuY29vcmRpbmF0ZXMubGVuZ3RoOyB9KTsKCgogICAgICAgICAgICAgICAgc3ZnLmFwcGVuZCgicGF0aCIpCiAgICAgICAgICAgICAgICAgICAgLmRhdHVtKHRvcG9qc29uLmZlYXR1cmUodXMsIHVzLm9iamVjdHMubGFuZCkpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoImNsYXNzIiwgImxhbmQiKQogICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZSgnZmlsbCcsJyNkZGQnKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgcGF0aCk7CgogICAgICAgICAgICAgICAgc3ZnLmFwcGVuZCgicGF0aCIpCiAgICAgICAgICAgICAgICAgICAgLmRhdHVtKHRvcG9qc29uLm1lc2godXMsIHVzLm9iamVjdHMuc3RhdGVzLCBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhICE9PSBiOyB9KSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAic3RhdGUtYm9yZGVycyIpCiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdmaWxsJywnbm9uZScpCiAgICAgICAgICAgICAgICAgICAgLy8gLnN0eWxlKCdzdHJva2UnLCcjZmZmJykKICAgICAgICAgICAgICAgICAgICAuYXR0cigiZCIsIHBhdGgpOwoKICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmQoInBhdGgiKQogICAgICAgICAgICAgICAgICAgIC5kYXR1bSh7dHlwZTogIk11bHRpUG9pbnQiLCBjb29yZGluYXRlczogYWlycG9ydHN9KQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJjbGFzcyIsICJhaXJwb3J0LWRvdHMiKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgcGF0aCk7CgogICAgICAgICAgICAgICAgdmFyIGFpcnBvcnQgPSBzdmcuc2VsZWN0QWxsKCIuYWlycG9ydCIpCiAgICAgICAgICAgICAgICAgICAgLmRhdGEoYWlycG9ydHMpCiAgICAgICAgICAgICAgICAgICAgLmVudGVyKCkuYXBwZW5kKCJnIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydCIpOwoKICAgICAgICAgICAgICAgIGFpcnBvcnQuYXBwZW5kKCJ0aXRsZSIpCiAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5pYXRhICsgIlxuIiArIGQuYXJjcy5jb29yZGluYXRlcy5sZW5ndGggKyAiIGZsaWdodHMiICsgIlxuIisibWVkaWFuIGRlbGF5OiAiK2QuZGVsYXkgKyIgbWludXRlcyI7IH0pOwoKICAgICAgICAgICAgICAgIGFpcnBvcnQuYXBwZW5kKCJwYXRoIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydC1hcmMiKQogICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZSgnZmlsbCcsJ25vbmUnKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gcGF0aChkLmFyY3MpOyB9KQogICAgICAgICAgICAgICAgICAgIC5vbigibW91c2VvdmVyIiwgZnVuY3Rpb24oZCkgeyBkMy5zZWxlY3QoIiNmb290ZXIgc3BhbiIpLnRleHQoZC5uYW1lKTsgfSk7CgogICAgICAgICAgICAgICAgYWlycG9ydC5hcHBlbmQoInBhdGgiKQogICAgICAgICAgICAgICAgICAgIC5kYXRhKHZvcm9ub2kucG9seWdvbnMoYWlycG9ydHMubWFwKHByb2plY3Rpb24pKSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydC1jZWxsIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiZCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQgPyAiTSIgKyBkLmpvaW4oIkwiKSArICJaIiA6IG51bGw7IH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgY2hhcnRfZGF0YT1wcmVwYXJlZGF0YShmbGlnaHRzKTsKICAgIHVwZGF0ZShjaGFydF9kYXRhKTsKCgogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiB0eXBlQWlycG9ydChkKSB7CiAgICAgICAgICAgICAgICBkWzBdID0gK2QubG9uZ2l0dWRlOwogICAgICAgICAgICAgICAgZFsxXSA9ICtkLmxhdGl0dWRlOwogICAgICAgICAgICAgICAgZC5hcmNzID0ge3R5cGU6ICJNdWx0aUxpbmVTdHJpbmciLCBjb29yZGluYXRlczogW119OwogICAgICAgICAgICAgICAgZC5kZWxheSA9IG51bGw7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHJldHVybiBkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiB0eXBlRmxpZ2h0KGQpIHsKICAgICAgICAgICAgICAgIGQuY291bnQgPSArZC5jb3VudDsKICAgICAgICAgICAgICAgIHJldHVybiBkOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2ZpbHRlcgoKICAgIC8vY29uc29sZS5sb2coYWlycG9ydHMpCgogICAgZDMuc2VsZWN0KCIjYWxsIikKICAgIC5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICBzZXRGaWx0ZXJNb2RlKCIjYWxsIikKICAgICAgICB2YXIgZG90cyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtZG90cycpCgogICAgZG90cwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBhcmNzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1hcmMnKQogICAgYXJjcwogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGFwID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydCcpCiAgICBhcAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGNlbGxzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1jZWxsJykKICAgIGNlbGxzCiAgICAgICAgLnJlbW92ZSgpOwogICAgICAgIAoKICAgICAgICB2YXIgbGFuZCA9IGQzLnNlbGVjdEFsbCgnLmxhbmQnKQogICAgbGFuZAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGJvYXJkZXJzID0gZDMuc2VsZWN0QWxsKCcuc3RhdGUtYm9hcmRlcicpCiAgICBib2FyZGVycwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBmbGlnaHRzLCBhaXJwb3J0cywgdXM7CiAgICBmbGlnaHRzID0gZmxpZ2h0czAuZmlsdGVyKGQgPT4gZC5jYXJyaWVyID09ICdhbGwnKTsKICAgIGFpcnBvcnRzID0gYWlycG9ydHMwOwogICAgdXMgPSB1czA7CiAgICB0cmFuc2l0aW9uTWFwKHVzLCBhaXJwb3J0cyxmbGlnaHRzKTsKICAgIAoKCgoKCgoKCiAgICB2YXIgY2hhcnRfZGF0YT1wcmVwYXJlZGF0YShmbGlnaHRzKQogICAgdXBkYXRlKGNoYXJ0X2RhdGEpCgoKICAgCiAgICB9KTsKICAgIAoKCiAgICAvL2NvbnNvbGUubG9nKGFpcnBvcnRzKQoKICAgIGQzLnNlbGVjdCgiI3VhIikKICAgIC5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICBzZXRGaWx0ZXJNb2RlKCIjdWEiKQogICAgICAgIHZhciBkb3RzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1kb3RzJykKCiAgICBkb3RzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGFyY3MgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWFyYycpCiAgICBhcmNzCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYXAgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0JykKICAgIGFwCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgY2VsbHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWNlbGwnKQogICAgY2VsbHMKICAgICAgICAucmVtb3ZlKCk7CiAgICAgICAgCgogICAgICAgIHZhciBsYW5kID0gZDMuc2VsZWN0QWxsKCcubGFuZCcpCiAgICBsYW5kCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYm9hcmRlcnMgPSBkMy5zZWxlY3RBbGwoJy5zdGF0ZS1ib2FyZGVyJykKICAgIGJvYXJkZXJzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGZsaWdodHMsIGFpcnBvcnRzLCB1czsKICAgIGZsaWdodHMgPSBmbGlnaHRzMC5maWx0ZXIoZCA9PiBkLmNhcnJpZXIgPT0gJ1VBJyk7CiAgICBhaXJwb3J0cyA9IGFpcnBvcnRzMDsKICAgIHVzID0gdXMwOwogICAgYWlycG9ydHMuYXJjcyA9IHt0eXBlOiAiTXVsdGlMaW5lU3RyaW5nIiwgY29vcmRpbmF0ZXM6IFtdfTsKICAgIHRyYW5zaXRpb25NYXAodXMsIGFpcnBvcnRzLGZsaWdodHMpOwogICAgdmFyIGNoYXJ0X2RhdGE9cHJlcGFyZWRhdGEoZmxpZ2h0cykKICAgIHVwZGF0ZShjaGFydF9kYXRhKQogICAgfSk7CgogICAgZDMuc2VsZWN0KCIjYWEiKQogICAgLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgIHNldEZpbHRlck1vZGUoIiNhYSIpCiAgICAgICAgdmFyIGRvdHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWRvdHMnKQoKICAgIGRvdHMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgYXJjcyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtYXJjJykKICAgIGFyY3MKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBhcCA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQnKQogICAgYXAKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBjZWxscyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtY2VsbCcpCiAgICBjZWxscwogICAgICAgIC5yZW1vdmUoKTsKICAgICAgICAKCiAgICAgICAgdmFyIGxhbmQgPSBkMy5zZWxlY3RBbGwoJy5sYW5kJykKICAgIGxhbmQKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBib2FyZGVycyA9IGQzLnNlbGVjdEFsbCgnLnN0YXRlLWJvYXJkZXInKQogICAgYm9hcmRlcnMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgZmxpZ2h0cywgYWlycG9ydHMsIHVzOwogICAgZmxpZ2h0cyA9IGZsaWdodHMwLmZpbHRlcihkID0+IGQuY2FycmllciA9PSAnQUEnKTsKICAgIGFpcnBvcnRzID0gYWlycG9ydHMwOwogICAgdXMgPSB1czA7CiAgICB0cmFuc2l0aW9uTWFwKHVzLCBhaXJwb3J0cyxmbGlnaHRzKTsKICAgIHZhciBjaGFydF9kYXRhPXByZXBhcmVkYXRhKGZsaWdodHMpCiAgICB1cGRhdGUoY2hhcnRfZGF0YSkKICAgIH0pOwoKICAgIGQzLnNlbGVjdCgiI2FzIikKICAgIC5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICBzZXRGaWx0ZXJNb2RlKCIjYXMiKQogICAgICAgIHZhciBkb3RzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1kb3RzJykKCiAgICBkb3RzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGFyY3MgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWFyYycpCiAgICBhcmNzCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYXAgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0JykKICAgIGFwCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgY2VsbHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWNlbGwnKQogICAgY2VsbHMKICAgICAgICAucmVtb3ZlKCk7CiAgICAgICAgCgogICAgICAgIHZhciBsYW5kID0gZDMuc2VsZWN0QWxsKCcubGFuZCcpCiAgICBsYW5kCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYm9hcmRlcnMgPSBkMy5zZWxlY3RBbGwoJy5zdGF0ZS1ib2FyZGVyJykKICAgIGJvYXJkZXJzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGZsaWdodHMsIGFpcnBvcnRzLCB1czsKICAgIGZsaWdodHMgPSBmbGlnaHRzMC5maWx0ZXIoZCA9PiBkLmNhcnJpZXIgPT0gJ0FTJyk7CiAgICBhaXJwb3J0cyA9IGFpcnBvcnRzMDsKICAgIHVzID0gdXMwOwogICAgdHJhbnNpdGlvbk1hcCh1cywgYWlycG9ydHMsZmxpZ2h0cyk7CiAgICB2YXIgY2hhcnRfZGF0YT1wcmVwYXJlZGF0YShmbGlnaHRzKQogICAgdXBkYXRlKGNoYXJ0X2RhdGEpCiAgICB9KTsKCiAgICBkMy5zZWxlY3QoIiNuayIpCiAgICAub24oImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgc2V0RmlsdGVyTW9kZSgiI25rIikKICAgICAgICB2YXIgZG90cyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtZG90cycpCgogICAgZG90cwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBhcmNzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1hcmMnKQogICAgYXJjcwogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGFwID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydCcpCiAgICBhcAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGNlbGxzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1jZWxsJykKICAgIGNlbGxzCiAgICAgICAgLnJlbW92ZSgpOwogICAgICAgIAoKICAgICAgICB2YXIgbGFuZCA9IGQzLnNlbGVjdEFsbCgnLmxhbmQnKQogICAgbGFuZAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGJvYXJkZXJzID0gZDMuc2VsZWN0QWxsKCcuc3RhdGUtYm9hcmRlcicpCiAgICBib2FyZGVycwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBmbGlnaHRzLCBhaXJwb3J0cywgdXM7CiAgICBmbGlnaHRzID0gZmxpZ2h0czAuZmlsdGVyKGQgPT4gZC5jYXJyaWVyID09ICdOSycpOwogICAgYWlycG9ydHMgPSBhaXJwb3J0czA7CiAgICB1cyA9IHVzMDsKICAgIHRyYW5zaXRpb25NYXAodXMsIGFpcnBvcnRzLGZsaWdodHMpOwogICAgdmFyIGNoYXJ0X2RhdGE9cHJlcGFyZWRhdGEoZmxpZ2h0cykKICAgIHVwZGF0ZShjaGFydF9kYXRhKQogICAgfSk7CgogICAgZDMuc2VsZWN0KCIjZGwiKQogICAgLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgIHNldEZpbHRlck1vZGUoIiNkbCIpCiAgICAgICAgdmFyIGRvdHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWRvdHMnKQoKICAgIGRvdHMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgYXJjcyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtYXJjJykKICAgIGFyY3MKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBhcCA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQnKQogICAgYXAKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBjZWxscyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtY2VsbCcpCiAgICBjZWxscwogICAgICAgIC5yZW1vdmUoKTsKICAgICAgICAKCiAgICAgICAgdmFyIGxhbmQgPSBkMy5zZWxlY3RBbGwoJy5sYW5kJykKICAgIGxhbmQKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBib2FyZGVycyA9IGQzLnNlbGVjdEFsbCgnLnN0YXRlLWJvYXJkZXInKQogICAgYm9hcmRlcnMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgZmxpZ2h0cywgYWlycG9ydHMsIHVzOwogICAgZmxpZ2h0cyA9IGZsaWdodHMwLmZpbHRlcihkID0+IGQuY2FycmllciA9PSAnREwnKTsKICAgIGFpcnBvcnRzID0gYWlycG9ydHMwOwogICAgdXMgPSB1czA7CiAgICB0cmFuc2l0aW9uTWFwKHVzLCBhaXJwb3J0cyxmbGlnaHRzKTsKICAgIHZhciBjaGFydF9kYXRhPXByZXBhcmVkYXRhKGZsaWdodHMpCiAgICB1cGRhdGUoY2hhcnRfZGF0YSkKICAgIH0pOwoKICAgIGQzLnNlbGVjdCgiI2hhIikKICAgIC5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICBzZXRGaWx0ZXJNb2RlKCIjaGEiKQogICAgICAgIHZhciBkb3RzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1kb3RzJykKCiAgICBkb3RzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGFyY3MgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWFyYycpCiAgICBhcmNzCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYXAgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0JykKICAgIGFwCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgY2VsbHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWNlbGwnKQogICAgY2VsbHMKICAgICAgICAucmVtb3ZlKCk7CiAgICAgICAgCgogICAgICAgIHZhciBsYW5kID0gZDMuc2VsZWN0QWxsKCcubGFuZCcpCiAgICBsYW5kCiAgICAgICAgLnJlbW92ZSgpOwoKICAgICAgICB2YXIgYm9hcmRlcnMgPSBkMy5zZWxlY3RBbGwoJy5zdGF0ZS1ib2FyZGVyJykKICAgIGJvYXJkZXJzCiAgICAgICAgLnJlbW92ZSgpOwogICAgdmFyIGZsaWdodHMsIGFpcnBvcnRzLCB1czsKICAgIGZsaWdodHMgPSBmbGlnaHRzMC5maWx0ZXIoZCA9PiBkLmNhcnJpZXIgPT0gJ0hBJyk7CiAgICBhaXJwb3J0cyA9IGFpcnBvcnRzMDsKICAgIHVzID0gdXMwOwogICAgdHJhbnNpdGlvbk1hcCh1cywgYWlycG9ydHMsZmxpZ2h0cyk7CiAgICB2YXIgY2hhcnRfZGF0YT1wcmVwYXJlZGF0YShmbGlnaHRzKQogICAgdXBkYXRlKGNoYXJ0X2RhdGEpCiAgICB9KTsKCiAgICBkMy5zZWxlY3QoIiN3biIpCiAgICAub24oImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgc2V0RmlsdGVyTW9kZSgiI3duIikKICAgICAgICB2YXIgZG90cyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtZG90cycpCgogICAgZG90cwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBhcmNzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1hcmMnKQogICAgYXJjcwogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGFwID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydCcpCiAgICBhcAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGNlbGxzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1jZWxsJykKICAgIGNlbGxzCiAgICAgICAgLnJlbW92ZSgpOwogICAgICAgIAoKICAgICAgICB2YXIgbGFuZCA9IGQzLnNlbGVjdEFsbCgnLmxhbmQnKQogICAgbGFuZAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGJvYXJkZXJzID0gZDMuc2VsZWN0QWxsKCcuc3RhdGUtYm9hcmRlcicpCiAgICBib2FyZGVycwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBmbGlnaHRzLCBhaXJwb3J0cywgdXM7CiAgICBmbGlnaHRzID0gZmxpZ2h0czAuZmlsdGVyKGQgPT4gZC5jYXJyaWVyID09ICdXTicpOwogICAgYWlycG9ydHMgPSBhaXJwb3J0czA7CiAgICB1cyA9IHVzMDsKICAgIHRyYW5zaXRpb25NYXAodXMsIGFpcnBvcnRzLGZsaWdodHMpOwogICAgdmFyIGNoYXJ0X2RhdGE9cHJlcGFyZWRhdGEoZmxpZ2h0cykKICAgIHVwZGF0ZShjaGFydF9kYXRhKQogICAgfSk7CgogICAgZDMuc2VsZWN0KCIjYjYiKQogICAgLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgIHNldEZpbHRlck1vZGUoIiNiNiIpCiAgICB2YXIgZG90cyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtZG90cycpCgogICAgZG90cwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBhcmNzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1hcmMnKQogICAgYXJjcwogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGFwID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydCcpCiAgICBhcAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGNlbGxzID0gZDMuc2VsZWN0QWxsKCcuYWlycG9ydC1jZWxsJykKICAgIGNlbGxzCiAgICAgICAgLnJlbW92ZSgpOwogICAgICAgIAoKICAgICAgICB2YXIgbGFuZCA9IGQzLnNlbGVjdEFsbCgnLmxhbmQnKQogICAgbGFuZAogICAgICAgIC5yZW1vdmUoKTsKCiAgICAgICAgdmFyIGJvYXJkZXJzID0gZDMuc2VsZWN0QWxsKCcuc3RhdGUtYm9hcmRlcicpCiAgICBib2FyZGVycwogICAgICAgIC5yZW1vdmUoKTsKICAgIHZhciBmbGlnaHRzLCBhaXJwb3J0cywgdXM7CiAgICBmbGlnaHRzID0gZmxpZ2h0czAuZmlsdGVyKGQgPT4gZC5jYXJyaWVyID09ICdCNicpOwogICAgYWlycG9ydHMgPSBhaXJwb3J0czA7CiAgICB1cyA9IHVzMDsKICAgIHRyYW5zaXRpb25NYXAodXMsIGFpcnBvcnRzLGZsaWdodHMpOwogICAgdmFyIGNoYXJ0X2RhdGE9cHJlcGFyZWRhdGEoZmxpZ2h0cykKICAgIHVwZGF0ZShjaGFydF9kYXRhKQogICAgfSk7CgogICAgZDMuc2VsZWN0KCIjZjkiKQogICAgLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsKICAgIHNldEZpbHRlck1vZGUoIiNmOSIpCiAgICAgICAgdmFyIGRvdHMgPSBkMy5zZWxlY3RBbGwoJy5haXJwb3J0LWRvdHMnKQoKICAgIGRvdHMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgYXJjcyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtYXJjJykKICAgIGFyY3MKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBhcCA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQnKQogICAgYXAKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBjZWxscyA9IGQzLnNlbGVjdEFsbCgnLmFpcnBvcnQtY2VsbCcpCiAgICBjZWxscwogICAgICAgIC5yZW1vdmUoKTsKICAgICAgICAKCiAgICAgICAgdmFyIGxhbmQgPSBkMy5zZWxlY3RBbGwoJy5sYW5kJykKICAgIGxhbmQKICAgICAgICAucmVtb3ZlKCk7CgogICAgICAgIHZhciBib2FyZGVycyA9IGQzLnNlbGVjdEFsbCgnLnN0YXRlLWJvYXJkZXInKQogICAgYm9hcmRlcnMKICAgICAgICAucmVtb3ZlKCk7CiAgICB2YXIgZmxpZ2h0cywgYWlycG9ydHMsIHVzOwogICAgZmxpZ2h0cyA9IGZsaWdodHMwLmZpbHRlcihkID0+IGQuY2FycmllciA9PSAnRjknKTsKICAgIGFpcnBvcnRzID0gYWlycG9ydHMwOwogICAgdXMgPSB1czA7CiAgICB0cmFuc2l0aW9uTWFwKHVzLCBhaXJwb3J0cyxmbGlnaHRzKTsKICAgIHZhciBjaGFydF9kYXRhPXByZXBhcmVkYXRhKGZsaWdodHMpCiAgICB1cGRhdGUoY2hhcnRfZGF0YSkKICAgIH0pOwoKICAgIGZ1bmN0aW9uIHNldEZpbHRlck1vZGUoaWQpIHsKICAgIGQzLnNlbGVjdCgiI2FsbCIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiN1YSIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNhYSIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNhcyIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNuayIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNkbCIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNoYSIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiN3biIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNiNiIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoIiNmOSIpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIndoaXRlIik7CiAgICBkMy5zZWxlY3QoaWQpLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgImdyZXkiKTsKICAgIGZpbHRlcl9tb2RlID0gaWQ7Cn0KCiAgICBmdW5jdGlvbiB0cmFuc2l0aW9uTWFwKHVzLGFpcnBvcnRzLGZsaWdodHMpIHsKICAgICAgICAvL2FpcnBvcnRzID0gW107CiAgICAgICAgLy8gY29uc29sZS5sb2coYWlycG9ydHNbMjUzMV0pIAogICAgICAgIC8vIGFpcnBvcnRzID0gZDMuY3N2KCdkYXRhL2FpcnBvcnRzLmNzdicsIHR5cGVBaXJwb3J0KSAgICAKCiAgICAgICAgdmFyIGFpcnBvcnRCeUlhdGEgPSBkMy5tYXAoYWlycG9ydHMsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuaWF0YTsgfSk7CgoKICAgICAgICAgICAgYWlycG9ydHMuZm9yRWFjaChmdW5jdGlvbihhaXJwb3J0KSB7CiAgICAgICAgICAgICAgICBhaXJwb3J0LmFyY3MuY29vcmRpbmF0ZXMgPSBbXTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgZmxpZ2h0cy5mb3JFYWNoKGZ1bmN0aW9uKGZsaWdodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhaXJwb3J0QnlJYXRhLmdldChmbGlnaHQub3JpZ2luKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gYWlycG9ydEJ5SWF0YS5nZXQoZmxpZ2h0LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAgICAgICBzb3VyY2UuYXJjcy5jb29yZGluYXRlcy5wdXNoKFtzb3VyY2UsIHRhcmdldF0pOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hcmNzLmNvb3JkaW5hdGVzLnB1c2goW3RhcmdldCwgc291cmNlXSk7CiAgICAgICAgICAgICAgICAgICAgc291cmNlLmRlbGF5ID0gZmxpZ2h0LmRlbGF5OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgYWlycG9ydHMgPSBhaXJwb3J0cwogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5hcmNzLmNvb3JkaW5hdGVzLmxlbmd0aDsgfSk7CgogICAgICAgICAgICAgICAgc3ZnLmFwcGVuZCgicGF0aCIpCiAgICAgICAgICAgICAgICAgICAgLmRhdHVtKHRvcG9qc29uLmZlYXR1cmUodXMsIHVzLm9iamVjdHMubGFuZCkpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoImNsYXNzIiwgImxhbmQiKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgcGF0aCk7CgogICAgICAgICAgICAgICAgc3ZnLmFwcGVuZCgicGF0aCIpCiAgICAgICAgICAgICAgICAgICAgLmRhdHVtKHRvcG9qc29uLm1lc2godXMsIHVzLm9iamVjdHMuc3RhdGVzLCBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhICE9PSBiOyB9KSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAic3RhdGUtYm9yZGVycyIpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoImQiLCBwYXRoKTsKCiAgICAgICAgICAgICAgICBzdmcuYXBwZW5kKCJwYXRoIikKICAgICAgICAgICAgICAgICAgICAuZGF0dW0oe3R5cGU6ICJNdWx0aVBvaW50IiwgY29vcmRpbmF0ZXM6IGFpcnBvcnRzfSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydC1kb3RzIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiZCIsIHBhdGgpOwoKICAgICAgICAgICAgICAgIHZhciBhaXJwb3J0ID0gc3ZnLnNlbGVjdEFsbCgiLmFpcnBvcnQiKQogICAgICAgICAgICAgICAgICAgIC5kYXRhKGFpcnBvcnRzKQogICAgICAgICAgICAgICAgICAgIC5lbnRlcigpLmFwcGVuZCgiZyIpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoImNsYXNzIiwgImFpcnBvcnQiKTsKICAgICAgICAgICAgICAgIGFpcnBvcnQuYXBwZW5kKCJ0aXRsZSIpCiAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5pYXRhICsgIlxuIiArIGQuYXJjcy5jb29yZGluYXRlcy5sZW5ndGggKyAiIGZsaWdodHMiICsgIlxuIisibWVkaWFuIGRlbGF5OiAiK2QuZGVsYXkgKyIgbWludXRlcyI7IH0pOwoKICAgICAgICAgICAgICAgIGFpcnBvcnQuYXBwZW5kKCJwYXRoIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydC1hcmMiKQogICAgICAgICAgICAgICAgICAgIC8vIC5zdHlsZSgnZmlsbCcsJ25vbmUnKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gcGF0aChkLmFyY3MpOyB9KQogICAgICAgICAgICAgICAgICAgIC5vbigibW91c2VvdmVyIiwgZnVuY3Rpb24oZCkgeyBkMy5zZWxlY3QoIiNmb290ZXIgc3BhbiIpLnRleHQoZC5uYW1lKTsgfSk7CgogICAgICAgICAgICAgICAgYWlycG9ydC5hcHBlbmQoInBhdGgiKQogICAgICAgICAgICAgICAgICAgIC5kYXRhKHZvcm9ub2kucG9seWdvbnMoYWlycG9ydHMubWFwKHByb2plY3Rpb24pKSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAiYWlycG9ydC1jZWxsIikKICAgICAgICAgICAgICAgICAgICAuYXR0cigiZCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQgPyAiTSIgKyBkLmpvaW4oIkwiKSArICJaIiA6IG51bGw7IH0pOwogICAgICAgIAp9CgoKICAgICAgICB9CiAgICB9Cg=="},{"version":3,"sources":["Map2.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA;;;;AAIA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA","file":"Map2.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div id=\"flight-map\">\n        <div id=\"footer\">\n        <span>U.S. Commercial Flights</span>, 2018\n        <div class=\"hint\">\n      mouseover for flights from each airport\n    </div>\n        </div>\n        <center>\n      <p>Filter By:\n          <button name=\"all\" class=\"btn btn-default\" id=\"all\">All</button>\n          <button name=\"ua\" class=\"btn btn-default\" id=\"ua\">United</button>\n          <button name=\"aa\" class=\"btn btn-default\" id=\"aa\">American</button>\n          <button name=\"as\" class=\"btn btn-default\" id=\"as\">Alaska</button>\n          <button name=\"nk\" class=\"btn btn-default\" id=\"nk\">Spirit</button>\n          <br>\n          <button name=\"dl\" class=\"btn btn-default\" id=\"dl\">Delta</button>\n          <button name=\"ha\" class=\"btn btn-default\" id=\"ha\">Hawaiian</button>\n          <button name=\"wn\" class=\"btn btn-default\" id=\"wn\">Southwest</button>\n          <button name=\"b6\" class=\"btn btn-default\" id=\"b6\">JetBlue</button>\n          <button name=\"f9\" class=\"btn btn-default\" id=\"f9\">Frontier</button>     \n      </p>\n      </center>\n        <svg width=\"960\" height=\"700\"></svg>\n        <p>Top 10 busy airport</p>\n        <svg width=\"800\" height=\"700\" id=\"chart\"></svg>\n    </div>\n</template>\n\n<script>\n\nfunction groupBy( array , f ) {\n                let groups = {};\n                array.forEach( function( o ) {\n                    let group = JSON.stringify( f(o) );\n                    groups[group] = groups[group] || [];\n                    groups[group].push( o );\n                });\n                return Object.keys(groups).map( function( group ) {\n                    return groups[group];\n                });\n            }\nfunction maxarr(arr,len){\n                var max=[];\n                arr.sort(function(a,b){\n                    return a['Count']-b['Count']\n                })\n                for (var i=0;i<len;i++){\n                    max.push(arr.pop())\n                }\n                return max.reverse()\n            }\nfunction preparedata(flights){\n    var grouped_all = groupBy(flights, function(item){\n                        return [item.origin];\n                    });\n                    var count=0.0;\n                    var num=0.0;\n                    var group_all=new Array()\n                    var dic=new Array()\n                    //console.log(grouped_all)\n                    grouped_all.forEach(\n                        function(e){\n                            count=0\n                            num=0\n                            e.forEach(\n                                function(m){\n                                    count=count+parseInt(m['delay']);\n                                    num=num+1;\n                                }\n                            )\n                            dic=[]\n                            dic['origin']=e[0]['origin']\n                            dic['delay']=count/num\n                            //console.log(dic)\n                            group_all.push(dic)\n                        }\n                    )\n\n\n                    \n\n                    var N=10\n                    group_all=maxarr(group_all,N)\n                    return group_all;\n}\nfunction update(data) {\n            data=data.sort(function(a,b){\n                return a.delay-b.delay;\n            })\n             var svg = d3.select(\"#chart\");\n             var rects = svg.selectAll(\"rect\")\n             .data(data, function (d) { return d.origin; });\n             rects.exit() //EXIT SELECTION -- here we decide to exit first\n             .transition()\n             .delay(1000)\n             .duration(1000)\n             .style(\"opacity\", 0)\n             .remove();\n\n             var yScale = d3.scaleLinear();\n                    var maxnum=0\n                    var minnum=10000000\n                    for (var i=0;i<data.length;i++){\n                        if (data[i]['delay']>maxnum){\n                            maxnum=data[i]['delay']\n                        }\n                        if (data[i]['delay']<minnum){\n                            minnum=data[i]['delay']\n                        }\n                    }\n\n                    yScale.domain([maxnum,minnum])\n                        .range([100,600]);\n\n\n\n            var colorlist=['#FF0000','#FF006B','#FF00EB','#CA00FF','#3800FF','#0000FF','#0094FF','#00FFFF','#00FFAD','#00FF00'];\n\n             rects.enter() //ENTER\n             .append(\"rect\")\n             .attr(\"fill\", function(d) { return d.c; })\n             .merge(rects) // UPDATE + ENTER\n             .transition()\n             .duration(3000)\n             .delay(function(d, i) { return i * 100; })\n             .attr(\"x\", 0)\n             .attr(\"y\", function(d, i) { return i * 35; })\n             .attr(\"width\", function(d) { return yScale(d.delay); })\n             .attr(\"height\", 25)\n             .attr(\"fill\", function(d, i) { return colorlist[i]; });\n            \n\n            svg.selectAll(\"#text\").remove();\n            var text=svg.selectAll(\"text\").data(data, function (d) { return d.origin; })\n            text.enter().append(\"text\")\n            .merge(rects) // UPDATE + ENTER\n             .transition()\n             .duration(3000)\n             .delay(function(d, i) { return i * 100; })\n            .text(function(d){\n                return d.origin;\n            }).attr(\"x\",function(d) { return yScale(d.delay)+50; })\n            .attr(\"y\", function(d, i) { return i * 35+20; })\n            .attr(\"id\",\"text\")\n\n\n             \n            }\n            \n\n\n\n\n\n    import * as d3 from 'd3v4';\n    import * as topojson from 'topojson';\n    export default {\n        name: \"Map2\",\n        mounted(){\n            var svg = d3.select(\"svg\"),\n                width = +svg.attr(\"width\"),\n                height = +svg.attr(\"height\");\n\n            var projection = d3.geoAlbers()\n                .translate([width *0.6, height * 0.6])\n                .scale(550);\n\n            // var radius = d3.scaleSqrt()\n            //     .domain([0, 100])\n            //     .range([0, 14]);\n\n            var path = d3.geoPath()\n                .projection(projection)\n                .pointRadius(2.5);\n\n            var voronoi = d3.voronoi()\n                .extent([[-1, -1], [width + 1, height + 1]]);\n\n            var filter_mode = \"#all\";\n            setFilterMode(filter_mode)\n\n            var airports0;\n            var flights0;\n            var us0;\n\n            d3.queue()\n                .defer(d3.json, \"data/us.json\")\n                .defer(d3.csv, \"data/airports.csv\", typeAirport)\n                .defer(d3.csv, \"data/flights-aggregation.csv\", typeFlight)\n                .await(ready);\n\n            function ready(error, us, airports, flights) {\n                if (error) throw error;\n                flights0 = flights.slice();\n                airports0 = airports.slice();\n                us0 = us;\n                // console.log(airports[2531])\n                flights = flights.filter(d => d.carrier == 'all');\n\n                var airportByIata = d3.map(airports, function(d) { return d.iata; });\n\n                flights.forEach(function(flight) {\n                    var source = airportByIata.get(flight.origin),\n                        target = airportByIata.get(flight.destination);\n                    source.arcs.coordinates.push([source, target]);\n                    target.arcs.coordinates.push([target, source]);\n                    source.delay = flight.delay;\n                });\n                // console.log(airports)\n\n                \n\n                airports = airports\n                    .filter(function(d) { return d.arcs.coordinates.length; });\n\n\n                svg.append(\"path\")\n                    .datum(topojson.feature(us, us.objects.land))\n                    .attr(\"class\", \"land\")\n                    // .style('fill','#ddd')\n                    .attr(\"d\", path);\n\n                svg.append(\"path\")\n                    .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))\n                    .attr(\"class\", \"state-borders\")\n                    // .style('fill','none')\n                    // .style('stroke','#fff')\n                    .attr(\"d\", path);\n\n                svg.append(\"path\")\n                    .datum({type: \"MultiPoint\", coordinates: airports})\n                    .attr(\"class\", \"airport-dots\")\n                    .attr(\"d\", path);\n\n                var airport = svg.selectAll(\".airport\")\n                    .data(airports)\n                    .enter().append(\"g\")\n                    .attr(\"class\", \"airport\");\n\n                airport.append(\"title\")\n                    .text(function(d) { return d.iata + \"\\n\" + d.arcs.coordinates.length + \" flights\" + \"\\n\"+\"median delay: \"+d.delay +\" minutes\"; });\n\n                airport.append(\"path\")\n                    .attr(\"class\", \"airport-arc\")\n                    // .style('fill','none')\n                    .attr(\"d\", function(d) { return path(d.arcs); })\n                    .on(\"mouseover\", function(d) { d3.select(\"#footer span\").text(d.name); });\n\n                airport.append(\"path\")\n                    .data(voronoi.polygons(airports.map(projection)))\n                    .attr(\"class\", \"airport-cell\")\n                    .attr(\"d\", function(d) { return d ? \"M\" + d.join(\"L\") + \"Z\" : null; });\n                \n                var chart_data=preparedata(flights);\n    update(chart_data);\n\n\n            }\n\n            function typeAirport(d) {\n                d[0] = +d.longitude;\n                d[1] = +d.latitude;\n                d.arcs = {type: \"MultiLineString\", coordinates: []};\n                d.delay = null;\n                \n                return d;\n            }\n\n            function typeFlight(d) {\n                d.count = +d.count;\n                return d;\n            }\n\n            //filter\n\n    //console.log(airports)\n\n    d3.select(\"#all\")\n    .on(\"click\", function () {\n    setFilterMode(\"#all\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'all');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    \n\n\n\n\n\n\n\n\n    var chart_data=preparedata(flights)\n    update(chart_data)\n\n\n   \n    });\n    \n\n\n    //console.log(airports)\n\n    d3.select(\"#ua\")\n    .on(\"click\", function () {\n    setFilterMode(\"#ua\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'UA');\n    airports = airports0;\n    us = us0;\n    airports.arcs = {type: \"MultiLineString\", coordinates: []};\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#aa\")\n    .on(\"click\", function () {\n    setFilterMode(\"#aa\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'AA');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#as\")\n    .on(\"click\", function () {\n    setFilterMode(\"#as\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'AS');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#nk\")\n    .on(\"click\", function () {\n    setFilterMode(\"#nk\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'NK');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#dl\")\n    .on(\"click\", function () {\n    setFilterMode(\"#dl\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'DL');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#ha\")\n    .on(\"click\", function () {\n    setFilterMode(\"#ha\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'HA');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#wn\")\n    .on(\"click\", function () {\n    setFilterMode(\"#wn\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'WN');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#b6\")\n    .on(\"click\", function () {\n    setFilterMode(\"#b6\")\n    var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'B6');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    d3.select(\"#f9\")\n    .on(\"click\", function () {\n    setFilterMode(\"#f9\")\n        var dots = d3.selectAll('.airport-dots')\n\n    dots\n        .remove();\n    var arcs = d3.selectAll('.airport-arc')\n    arcs\n        .remove();\n\n        var ap = d3.selectAll('.airport')\n    ap\n        .remove();\n\n        var cells = d3.selectAll('.airport-cell')\n    cells\n        .remove();\n        \n\n        var land = d3.selectAll('.land')\n    land\n        .remove();\n\n        var boarders = d3.selectAll('.state-boarder')\n    boarders\n        .remove();\n    var flights, airports, us;\n    flights = flights0.filter(d => d.carrier == 'F9');\n    airports = airports0;\n    us = us0;\n    transitionMap(us, airports,flights);\n    var chart_data=preparedata(flights)\n    update(chart_data)\n    });\n\n    function setFilterMode(id) {\n    d3.select(\"#all\").style(\"background-color\", \"white\");\n    d3.select(\"#ua\").style(\"background-color\", \"white\");\n    d3.select(\"#aa\").style(\"background-color\", \"white\");\n    d3.select(\"#as\").style(\"background-color\", \"white\");\n    d3.select(\"#nk\").style(\"background-color\", \"white\");\n    d3.select(\"#dl\").style(\"background-color\", \"white\");\n    d3.select(\"#ha\").style(\"background-color\", \"white\");\n    d3.select(\"#wn\").style(\"background-color\", \"white\");\n    d3.select(\"#b6\").style(\"background-color\", \"white\");\n    d3.select(\"#f9\").style(\"background-color\", \"white\");\n    d3.select(id).style(\"background-color\", \"grey\");\n    filter_mode = id;\n}\n\n    function transitionMap(us,airports,flights) {\n        //airports = [];\n        // console.log(airports[2531]) \n        // airports = d3.csv('data/airports.csv', typeAirport)    \n\n        var airportByIata = d3.map(airports, function(d) { return d.iata; });\n\n\n            airports.forEach(function(airport) {\n                airport.arcs.coordinates = [];\n            });\n\n                flights.forEach(function(flight) {\n                    var source = airportByIata.get(flight.origin),\n                        target = airportByIata.get(flight.destination);\n                    source.arcs.coordinates.push([source, target]);\n                    target.arcs.coordinates.push([target, source]);\n                    source.delay = flight.delay;\n                });\n\n                airports = airports\n                    .filter(function(d) { return d.arcs.coordinates.length; });\n\n                svg.append(\"path\")\n                    .datum(topojson.feature(us, us.objects.land))\n                    .attr(\"class\", \"land\")\n                    .attr(\"d\", path);\n\n                svg.append(\"path\")\n                    .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))\n                    .attr(\"class\", \"state-borders\")\n                    .attr(\"d\", path);\n\n                svg.append(\"path\")\n                    .datum({type: \"MultiPoint\", coordinates: airports})\n                    .attr(\"class\", \"airport-dots\")\n                    .attr(\"d\", path);\n\n                var airport = svg.selectAll(\".airport\")\n                    .data(airports)\n                    .enter().append(\"g\")\n                    .attr(\"class\", \"airport\");\n                airport.append(\"title\")\n                    .text(function(d) { return d.iata + \"\\n\" + d.arcs.coordinates.length + \" flights\" + \"\\n\"+\"median delay: \"+d.delay +\" minutes\"; });\n\n                airport.append(\"path\")\n                    .attr(\"class\", \"airport-arc\")\n                    // .style('fill','none')\n                    .attr(\"d\", function(d) { return path(d.arcs); })\n                    .on(\"mouseover\", function(d) { d3.select(\"#footer span\").text(d.name); });\n\n                airport.append(\"path\")\n                    .data(voronoi.polygons(airports.map(projection)))\n                    .attr(\"class\", \"airport-cell\")\n                    .attr(\"d\", function(d) { return d ? \"M\" + d.join(\"L\") + \"Z\" : null; });\n        \n}\n\n\n        }\n    }\n</script>\n<style>\n\n    .land {\n        fill: #ddd;\n    }\n\n    .state-borders {\n        fill: none;\n        stroke: #fff;\n    }\n\n    .airport-arc {\n        fill: none;\n    }\n\n    .airport:hover .airport-arc {\n        stroke: #f00;\n    }\n\n    .airport-cell {\n        fill: none;\n        stroke: #000;\n        stroke-opacity: 0.1;\n        pointer-events: all;\n    }\n\n</style>"]}]}